<!doctype html>
<html>
<head>
	<title>Sky Data</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Raleway" />
	<script src='https://unpkg.com/intersection-observer@0.5.0/intersection-observer.js'></script>
	<script src='https://unpkg.com/scrollama'></script>
	<link rel="stylesheet" type="text/css" href="style.css">


</head>
<body>
	<section id="banner">
		<!--<div class="sticky">-->
		<h1>Sky Data</h1>
		<p>A Visualisation of Social Media Perception of Weather</p>
		<!--</div>-->
	</section>

	<section id='intro'>
		<div id="blogMargin">
			<h3>The Idea</h3>
			<div class="floaters">
				<p><img id='tweets' src="resources/TweetsMontage.png">Social media is a powerful platform to share opinions, ideas, experiences and information. The data collected from these platforms can give us useful insights. Geologists and climatologists are constantly observing and plotting patterns for changes in the Earthâ€™s atmosphere. For this article we collected weather related tweets from users located in New York. Using this data we made weather visualizations for the past year for the city of New York. <br><br>The motive was to highlight minor deviations between the perceived and actual weather from this data on the lowest level which might not be captured by the weather department. The weather in New York is unpredictable enough to give us enough supporting evidence of this deviation in actual and perceived weather. We will discuss this further in the article.</p>
			</div>
			<h3>The Process</h3>
			<img id='process' src="resources/flow1b.png">
			<p style="font-weight: bold;">Data Collection</p>
			<p>We handpicked tweets for the past year (Nov, 2017 - Oct, 2018) for the city of New York using advanced Twitter filters. We used hashtags like #NYC, #weather, #<''month name''> and a few others. We also collected a detailed dataset for the month of October. The dataset had information like user name, date, tweet and the hashtags used. We got the original weather forecast dataset from National Center for Environmental Information.</p>
			<br>
			<section id="data_mapping"><p style="font-weight: bold;">Data Mapping</p></section>
			<p>We analysed the tweets to derive a scale of temperature that was felt by the users during the year. We got values ranging from <span id="temp">"Very Hot"(tempartures between 85-95 F) to "Very Cold"(35-44 F)</span>. Each tweet was qualitatively analysed before being associated with a value from the scale.</p>
			<br>
			<p style="font-weight: bold;">Data Visualization</p>
			<p>After curating the dataset we then created the visualizations for yearly tweets as well as a focused monthly visualization for October. For our final visualization we used a radial chart to represent the yearly weather pattern derived from the dataset. We used the global color scale of temperature for easy understanding.
				The radial chart also helps in showing cyclic weather patterns throughout the year. After making the individual visualizations for the actual and observed weather patterns, we made a simple line graph for the comparison of the two to get an overview of the discrepancies in the weather predictions by the meteorology department.</p>
			<br>
			<p style="color: #5385c1;">Scroll down to view our findings.</p>
			<!--<img src='1.png'>-->
			<br>
			<p class='intro__dek'>

			</p>
		</div>
	</section>
	<section id='scroll'>
		<!--  graphic container  -->
		<div class='scroll__graphic'>
			<!--   actual graphic/chart   -->
			<div class='chart'>
				<!--<div class="imgCont">0</div>-->
				<img id='imgBox' src="resources/YF.png" style="max-height: 729px; max-width: 890px;">
			</div>
		</div>

		<!--  step/text container  -->
		<div class='scroll__text'>
			<div class='step' data-step='1'>
				<br>
				<section id="perceived_viz"><h3>The Year Visualized</h3></section>
				<p>This was weather feeling of twitter users for the year starting Nov, 2017 to Oct, 2018 in NYC. There are some interesting variations in temperature over the year where the weather was unexpectedly hot in the winter months and often times pleasant in the hot months.</p>
			</div>
			<div class='step' data-step='2'>
				<br>
				<h3>October Visualized</h3>
				<p>This was weather feeling of twitter users for the month of October 2018 in NYC. There were small spurts of hikes or drops in temperature but it was a relatively pleasant month with temperatures matching the fall season vibes. </p>
			</div>
			<div class='step' data-step='3'>
				<br>
				<h3>Behind the Visualization</h3>
				<p>Each tweet was qualitatively analysed and manually coded for each value on our scale("Very Hot to Very Cold"). Every individual code has an underlying temperature range which we determined from the recorded low and high temperature of NYC. Find this coding <a href="#data_mapping" onclick="document.getElementById('temp').style='background-color:lightgoldenrodyellow';setTimeout(highlight, 3000);">here</a>.</p>
			</div>
			<div class='step' data-step='4'>
				<br>
				<section id="actual_viz"><h3>Actual Weather Visualized</h3></section>
				<p>We picked the official weather forecast dataset from NOAA and made a visualization of the predicted weather for the same year. As expected, there is a notable difference between the two visualizations (Percieved and Actual).  In general, the spread of the cold weather is larger in the <a href="#perceived_viz">perceived visualization</a> as compared to the actual one.</p>
			</div>
			<div class='step' data-step='5'>
				<br>
				<h3>Actual vs Perceived Weather</h3>
				<p> The visualization for the average temperatures(average of the min and max temp) of actual and perceived weather shows a significant mismatch. However since the comparison is made on average estimates of twitter users' perception, some of the closely coupled deviations could be ignored. Apart from these, there are several deviations which are drastic enough to not be ignored.</p>
			</div>
		</div>
	</section>
	<section id="foot" class="footer">
		<div class="inner">
			<header>
				<h2>The Authors</h2>
			</header>
			<div class="arrange">
				<div class="box">
					<div class="round">
						<img src="resources/Dhruvi_DP.jpg" alt="Person 1" />
					</div>
					<h4>Dhruvi Patel</h4>
					<p>University of Maryland</p>
				</div>

				<div class="box">
					<div class="round">
						<img src="resources/Mahitha_DP.JPG" alt="Person 2" />
					</div>
					<h4>Mahitha Kalyani</h4>
					<p>University of Maryland</p>
				</div>

			</div>
		</div>
	</section>
	<div class="copyright">
		&copy; Dhruvi Patel. Mahitha Kalyani.  Design: <a href="https://templated.co">TEMPLATED</a>. Scroller: <a href="https://github.com/russellgoldenberg/scrollama">Russell Goldenberg</a>. Banner Image: <a href="https://unsplash.com">Unsplash</a>.
	</div>
	<script>
	var container = d3.select('#scroll');
	var graphic = container.select('.scroll__graphic');
	var chart = graphic.select('.chart');
	var text = container.select('.scroll__text');
	var step = text.selectAll('.step');
	// initialize the scrollama
	var scroller = scrollama();
	var chartWidth;
	//scroller.style.visibility='hidden';
	// generic window resize listener event
	function handleResize() {
		// 1. update height of step elements
		//var stepHeight = Math.floor(window.innerHeight * 0.75);
		var stepHeight = Math.floor(window.innerHeight);
		step.style('height', stepHeight + 'px');
		// 2. update width/height of graphic element
		var bodyWidth = d3.select('body').node().offsetWidth;
		graphic
		.style('width', bodyWidth + 'px')
		.style('height', window.innerHeight + 'px');
		var chartMargin = 32;
		var textWidth = text.node().offsetWidth;
		//var chartWidth = graphic.node().offsetWidth - textWidth - chartMargin;
		chartWidth = graphic.node().offsetWidth - textWidth - chartMargin;
		chart
		.style('width', chartWidth + 'px')
		//.style('height', Math.floor(window.innerHeight / 2) + 'px');
		.style('height', Math.floor(window.innerHeight * 0.70) + 'px');
		// 3. tell scrollama to update new element dimensions
		scroller.resize();

	}
	// scrollama event handlers
	function handleStepEnter(response) {
		// response = { element, direction, index }
		// add color to current step only
		step.classed('is-active', function (d, i) {
			return i === response.index;
		})
		// update graphic based on step
		//chart.select('p').text(response.index + 1)
		/*
		var svg = d3.select('body').append('svg').attr({
		width: 300,
		height: 300,
		border: '1px solid #ccc'
	});

	svg.append('svg:image')
	.attr({
	'xlink:href': 'https://drive.google.com/file/d/1DphNXDPQ4g46aR3I1TzhxzwhP60TzXfP/view?usp=sharing',  // can also add svg file here
	x: 0,
	y: 0,
	width: 128,
	height: 128
})
*/
if(response.index==0){
	document.getElementById('imgBox').src="resources/YF.png";
	document.getElementById('imgBox').style.height='729px';
	document.getElementById('imgBox').style.width=chartWidth;
}
if(response.index==1){
	document.getElementById('imgBox').src="resources/OF_v2.png";
	document.getElementById('imgBox').style.height='729px';
	document.getElementById('imgBox').style.width=chartWidth;
}
if(response.index==2){
	document.getElementById('imgBox').src="resources/WeatherOctOverlay.png";
	document.getElementById('imgBox').style.height='729px';
	document.getElementById('imgBox').style.width=chartWidth;
}
if(response.index==3){
	document.getElementById('imgBox').src="resources/ActualTemp.png";
	document.getElementById('imgBox').style.height='729px';
	document.getElementById('imgBox').style.width=chartWidth;
}
if(response.index==4){
	document.getElementById('imgBox').src="resources/Compare.png";
	document.getElementById('imgBox').style.height='729px';
	document.getElementById('imgBox').style.width=chartWidth;
}
}
function handleContainerEnter(response) {
	// response = { direction }
	// sticky the graphic (old school)
	graphic.classed('is-fixed', true);
	graphic.classed('is-bottom', false);
}
function handleContainerExit(response) {
	// response = { direction }
	// un-sticky the graphic, and pin to top/bottom of container
	graphic.classed('is-fixed', false);
	graphic.classed('is-bottom', response.direction === 'down');
}
function init() {
	// 1. force a resize on load to ensure proper dimensions are sent to scrollama
	handleResize();
	// 2. setup the scroller passing options
	// this will also initialize trigger observations
	// 3. bind scrollama event handlers (this can be chained like below)
	scroller.setup({
		container: '#scroll',
		graphic: '.scroll__graphic',
		text: '.scroll__text',
		step: '.scroll__text .step',
		debug: false,
	})
	.onStepEnter(handleStepEnter)
	.onContainerEnter(handleContainerEnter)
	.onContainerExit(handleContainerExit);
	// setup resize event
	window.addEventListener('resize', handleResize);
}
// kick things off
function highlight(){
 document.getElementById("temp").style='background-color:white;';
}

init();
</script>
</body>
</html>
