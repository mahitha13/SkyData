<!doctype html>
<html>
<head>
	<title>Sky Data</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src='https://unpkg.com/intersection-observer@0.5.0/intersection-observer.js'></script>
	<script src='https://unpkg.com/scrollama'></script>
    <link rel="stylesheet" type="text/css" href="style.css">


</head>
<body>
    <div>
        <p class="heading1" style="text-align:center;margin-bottom:0px;">Sky Data</p>
        <p class="heading2" style="text-align:center;margin-top:10px;">A visualisation of data on Social Media Perception of weather</p>
    </div>


    <section id='intro'>
    	<div id="blogMargin">
        <p>Data from social media was collected manually to get user perspective of local weather. We have focused on NYC for the scope of this study.</p>
        <p>Some text</p>
    	<!--<img src='1.png'>-->
		<p class='intro__dek'>
			Start scrolling to view more
		</p>
		</div>
	</section>
    <section id='scroll'>
	<!--  graphic container  -->
	<div class='scroll__graphic'>
		<!--   actual graphic/chart   -->
		<div class='chart'>
			<!--<div class="imgCont">0</div>-->
			<img id='imgBox' style="max-height: 395px; max-width: 890px;" src="https://images.pexels.com/photos/248797/pexels-photo-248797.jpeg?auto=compress&cs=tinysrgb&h=350">
		</div>
	</div>

	<!--  step/text container  -->
	<div class='scroll__text'>
		<div class='step' data-step='1'>
			<p>We came up with this visualization</p>
		</div>
		<div class='step' data-step='2'>
			<p>STEP 2</p>
		</div>
		<div class='step' data-step='3'>
			<p>STEP 3</p>
		</div>
		<div class='step' data-step='4'>
			<p>STEP 4</p>
		</div>
	</div>
	</section>
	<script>
        var container = d3.select('#scroll');
		var graphic = container.select('.scroll__graphic');
		var chart = graphic.select('.chart');
		var text = container.select('.scroll__text');
		var step = text.selectAll('.step');
		// initialize the scrollama
		var scroller = scrollama();

		//scroller.style.visibility='hidden';
		// generic window resize listener event
		function handleResize() {
			// 1. update height of step elements
			//var stepHeight = Math.floor(window.innerHeight * 0.75);
			var stepHeight = Math.floor(window.innerHeight * 0.70);
			step.style('height', stepHeight + 'px');
			// 2. update width/height of graphic element
			var bodyWidth = d3.select('body').node().offsetWidth;
			graphic
				.style('width', bodyWidth + 'px')
				.style('height', window.innerHeight + 'px');
			var chartMargin = 32;
			var textWidth = text.node().offsetWidth;
			var chartWidth = graphic.node().offsetWidth - textWidth - chartMargin;
			chart
				.style('width', chartWidth + 'px')
				.style('height', Math.floor(window.innerHeight / 2) + 'px');
			// 3. tell scrollama to update new element dimensions
			scroller.resize();

		}
		// scrollama event handlers
		function handleStepEnter(response) {
			// response = { element, direction, index }
			// add color to current step only
			step.classed('is-active', function (d, i) {
				return i === response.index;
			})
			// update graphic based on step
			//chart.select('p').text(response.index + 1)
			/*
			var svg = d3.select('body').append('svg').attr({
			  width: 300,
			  height: 300,
			  border: '1px solid #ccc'
			});

			svg.append('svg:image')
			.attr({
			  'xlink:href': 'https://drive.google.com/file/d/1DphNXDPQ4g46aR3I1TzhxzwhP60TzXfP/view?usp=sharing',  // can also add svg file here
			  x: 0,
			  y: 0,
			  width: 128,
			  height: 128
			})
*/
			if(response.index==0){
				document.getElementById('imgBox').src="resources/1.png";
				document.getElementById('imgBox').style.height='395px';
				document.getElementById('imgBox').style.width='890px';
			}
			if(response.index==1){
				document.getElementById('imgBox').src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/242ce817-97a3-48fe-9acd-b1bf97930b01/09-posterization-opt.jpg";
				document.getElementById('imgBox').style.height='395px';
				document.getElementById('imgBox').style.width='890px';
			}
			if(response.index==3){
				document.getElementById('imgBox').src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/242ce817-97a3-48fe-9acd-b1bf97930b01/09-posterization-opt.jpg";
				document.getElementById('imgBox').style.height='395px';
				document.getElementById('imgBox').style.width='890px';
			}
			if(response.index==4){
				document.getElementById('imgBox').src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/242ce817-97a3-48fe-9acd-b1bf97930b01/09-posterization-opt.jpg";
				document.getElementById('imgBox').style.height='395px';
				document.getElementById('imgBox').style.width='890px';
			}
			}
		function handleContainerEnter(response) {
			// response = { direction }
			// sticky the graphic (old school)
			graphic.classed('is-fixed', true);
			graphic.classed('is-bottom', false);
		}
		function handleContainerExit(response) {
			// response = { direction }
			// un-sticky the graphic, and pin to top/bottom of container
			graphic.classed('is-fixed', false);
			graphic.classed('is-bottom', response.direction === 'down');
		}
		function init() {
			// 1. force a resize on load to ensure proper dimensions are sent to scrollama
			handleResize();
			// 2. setup the scroller passing options
			// this will also initialize trigger observations
			// 3. bind scrollama event handlers (this can be chained like below)
			scroller.setup({
				container: '#scroll',
				graphic: '.scroll__graphic',
				text: '.scroll__text',
				step: '.scroll__text .step',
				debug: false,
			})
				.onStepEnter(handleStepEnter)
				.onContainerEnter(handleContainerEnter)
				.onContainerExit(handleContainerExit);
			// setup resize event
			window.addEventListener('resize', handleResize);
		}
		// kick things off
		init();
    </script>
</body>
</html>
